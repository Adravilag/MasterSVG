<div class="container">
  <!-- Compact Header -->
  <div class="header">
    <div class="header-left">
      <div class="logo-mini">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
        </svg>
      </div>
      <span class="header-title">${appTitle}</span>
    </div>
    <div class="header-features">
      <div class="header-feature"><svg viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg> ${headerIcons}</div>
      <div class="header-feature"><svg viewBox="0 0 24 24"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/></svg> ${headerColors}</div>
      <div class="header-feature"><svg viewBox="0 0 24 24"><path d="M12 2L4.5 20.29l.71.71L12 18l6.79 3 .71-.71L12 2z"/></svg> ${headerAnimations}</div>
      <div class="header-feature"><svg viewBox="0 0 24 24"><path d="M11 21h-1l1-7H7.5c-.58 0-.57-.32-.38-.66.19-.34.05-.08.07-.12C8.48 10.94 10.42 7.54 13 3h1l-1 7h3.5c.49 0 .56.33.47.51l-.07.15C12.96 17.55 11 21 11 21z"/></svg> ${headerSvgo}</div>
      <!-- Language Selector -->
      <div class="header-language">
        <select id="languageSelect" onchange="setLanguage(this.value)" title="${languageLabel}">
          ${languageOptions}
        </select>
      </div>
    </div>
  </div>

  <div class="main-layout">
    <!-- Left Column: Configuration -->
    <div class="config-column">
      <!-- Step 0: Frontend Root -->
      <div class="step ${step0Class}">
        <div class="step-header">
          <div class="step-number ${step0NumberClass}"><span>0</span></div>
          <div class="step-title">${step0Title}</div>
          ${step0Summary}
        </div>
        <div class="step-content">
          <p class="step-description">${step0Desc}</p>

          <div class="options-grid">
            ${frontendRootOptions}
            <div class="option browse" onclick="chooseFrontendFolder()">
              <span class="option-icon"><svg viewBox="0 0 24 24"><path d="M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V8h16v10z"/></svg></span>
              <span class="option-label">${browse}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Step 3: Build Format -->
      <div class="step ${step3Class}">
        <div class="step-header">
          <div class="step-number ${step3NumberClass}"><span>1</span></div>
          <div class="step-title">${step3Title}</div>
          <span class="step-summary" style="color: var(--vscode-descriptionForeground);">${formatSummary}</span>
        </div>
        <div class="step-content">
          <p class="step-description">
            ${step3Desc}
            <span class="help-link" onclick="toggleHelp()">${step3Help} ▾</span>
          </p>

          <div class="format-layout">
          <!-- Left: Framework + Options -->
          <div class="format-left">

          <!-- Framework Selector -->
          <div class="framework-selector">
            <label class="framework-label">${frameworkLabel}</label>
            <div class="framework-options">
              <div class="framework-option ${frameworkHtmlSelected}" onclick="setFramework('html')" title="HTML + Web Components">
                <span class="framework-icon"><svg viewBox="0 0 128 128"><path fill="#e44d26" d="M19.037 113.876L9.032 1.661h109.936l-10.016 112.198l-45.019 12.48z"/><path fill="#f16529" d="m64 116.8l36.378-10.086l8.559-95.878H64z"/><path fill="#ebebeb" d="M64 52.455H45.788L44.53 38.361H64V24.599H29.489l.33 3.692l3.382 37.927H64zm0 35.743l-.061.017l-15.327-4.14l-.979-10.975H33.816l1.928 21.609l28.193 7.826l.063-.017z"/><path fill="#fff" d="M63.952 52.455v13.763h16.947l-1.597 17.849l-15.35 4.143v14.319l28.215-7.82l.207-2.325l3.234-36.233l.335-3.696h-3.708zm0-27.856v13.762h33.244l.276-3.092l.628-6.978l.329-3.692z"/></svg></span>
                <span class="framework-name">HTML</span>
              </div>
              <div class="framework-option ${frameworkReactSelected}" onclick="setFramework('react')" title="React / Next.js">
                <span class="framework-icon"><svg viewBox="0 0 32 32"><circle cx="16" cy="15.974" r="2.5" fill="#00d8ff"/><path fill="#00d8ff" d="M16 21.706a28.4 28.4 0 0 1-8.88-1.2a11.3 11.3 0 0 1-3.657-1.958A3.54 3.54 0 0 1 2 15.974c0-1.653 1.816-3.273 4.858-4.333A28.8 28.8 0 0 1 16 10.293a28.7 28.7 0 0 1 9.022 1.324a11.4 11.4 0 0 1 3.538 1.866A3.4 3.4 0 0 1 30 15.974c0 1.718-2.03 3.459-5.3 4.541a28.8 28.8 0 0 1-8.7 1.191m0-10.217a28 28 0 0 0-8.749 1.282c-2.8.977-4.055 2.313-4.055 3.2c0 .928 1.349 2.387 4.311 3.4A27.2 27.2 0 0 0 16 20.51a27.6 27.6 0 0 0 8.325-1.13C27.4 18.361 28.8 16.9 28.8 15.974a2.33 2.33 0 0 0-1.01-1.573a10.2 10.2 0 0 0-3.161-1.654A27.5 27.5 0 0 0 16 11.489"/><path fill="#00d8ff" d="M10.32 28.443a2.64 2.64 0 0 1-1.336-.328c-1.432-.826-1.928-3.208-1.327-6.373a28.8 28.8 0 0 1 3.4-8.593a28.7 28.7 0 0 1 5.653-7.154a11.4 11.4 0 0 1 3.384-2.133a3.4 3.4 0 0 1 2.878 0c1.489.858 1.982 3.486 1.287 6.859a28.8 28.8 0 0 1-3.316 8.133a28.4 28.4 0 0 1-5.476 7.093a11.3 11.3 0 0 1-3.523 2.189a4.9 4.9 0 0 1-1.624.307m1.773-14.7a28 28 0 0 0-3.26 8.219c-.553 2.915-.022 4.668.75 5.114c.8.463 2.742.024 5.1-2.036a27.2 27.2 0 0 0 5.227-6.79a27.6 27.6 0 0 0 3.181-7.776c.654-3.175.089-5.119-.713-5.581a2.33 2.33 0 0 0-1.868.089A10.2 10.2 0 0 0 17.5 6.9a27.5 27.5 0 0 0-5.4 6.849Z"/><path fill="#00d8ff" d="M21.677 28.456c-1.355 0-3.076-.82-4.868-2.361a28.8 28.8 0 0 1-5.747-7.237a28.7 28.7 0 0 1-3.374-8.471a11.4 11.4 0 0 1-.158-4A3.4 3.4 0 0 1 8.964 3.9c1.487-.861 4.01.024 6.585 2.31a28.8 28.8 0 0 1 5.39 6.934a28.4 28.4 0 0 1 3.41 8.287a11.3 11.3 0 0 1 .137 4.146a3.54 3.54 0 0 1-1.494 2.555a2.6 2.6 0 0 1-1.315.324m-9.58-10.2a28 28 0 0 0 5.492 6.929c2.249 1.935 4.033 2.351 4.8 1.9c.8-.465 1.39-2.363.782-5.434A27.2 27.2 0 0 0 19.9 13.74a27.6 27.6 0 0 0-5.145-6.64c-2.424-2.152-4.39-2.633-5.191-2.169a2.33 2.33 0 0 0-.855 1.662a10.2 10.2 0 0 0 .153 3.565a27.5 27.5 0 0 0 3.236 8.1Z"/></svg></span>
                <span class="framework-name">React</span>
              </div>
              <div class="framework-option ${frameworkVueSelected}" onclick="setFramework('vue')" title="Vue.js / Nuxt">
                <span class="framework-icon"><svg viewBox="0 0 256 221"><path fill="#41b883" d="M204.8 0H256L128 220.8L0 0h97.92L128 51.2L157.44 0z"/><path fill="#41b883" d="m0 0l128 220.8L256 0h-51.2L128 132.48L50.56 0z"/><path fill="#35495e" d="M50.56 0L128 133.12L204.8 0h-47.36L128 51.2L97.92 0z"/></svg></span>
                <span class="framework-name">Vue</span>
              </div>
              <div class="framework-option ${frameworkAngularSelected}" onclick="setFramework('angular')" title="Angular">
                <span class="framework-icon"><svg viewBox="0 0 128 128"><defs><linearGradient id="angularGrad1" x1="14.704" x2="110.985" y1="46.27" y2="92.024" gradientTransform="matrix(1 0 0 -1 0 130)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#e40035"/><stop offset=".24" stop-color="#f60a48"/><stop offset=".352" stop-color="#f20755"/><stop offset=".494" stop-color="#dc087d"/><stop offset=".745" stop-color="#9717e7"/><stop offset="1" stop-color="#6c00f5"/></linearGradient><linearGradient id="angularGrad2" x1="28.733" x2="91.742" y1="117.071" y2="45.195" gradientTransform="matrix(1 0 0 -1 0 130)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#ff31d9"/><stop offset="1" stop-color="#ff5be1" stop-opacity="0"/></linearGradient></defs><path fill="url(#angularGrad1)" d="m124.5 21.3l-4.4 68.6L78.3 0zm-29 88.7L64 128l-31.5-18l6.4-15.5h50.3zM64 34.1l16.5 40.2h-33zM7.9 89.9L3.5 21.3L49.7 0z"/><path fill="url(#angularGrad2)" d="m124.5 21.3l-4.4 68.6L78.3 0zm-29 88.7L64 128l-31.5-18l6.4-15.5h50.3zM64 34.1l16.5 40.2h-33zM7.9 89.9L3.5 21.3L49.7 0z"/></svg></span>
                <span class="framework-name">Angular</span>
              </div>
              <div class="framework-option ${frameworkSvelteSelected}" onclick="setFramework('svelte')" title="Svelte / SvelteKit">
                <span class="framework-icon"><svg viewBox="0 0 128 128"><path fill="#ff3e00" d="M110.43 16.936C98.553-.076 75.09-5.118 58.13 5.696l-29.792 19a34.2 34.2 0 0 0-15.48 22.897a25.478 30.64 0 0 0-.572 6.396a36.15 36.15 0 0 0 4.163 16.73A34.4 34.4 0 0 0 11.34 83.5a25.348 30.483 0 0 0 .345 14.412a36.5 36.5 0 0 0 5.9 13.152c11.878 17.01 35.394 22.053 52.3 11.24l29.762-19.001a34.13 34.13 0 0 0 15.438-22.918a35.5 35.5 0 0 0 .572-6.386a36.2 36.2 0 0 0-4.112-16.71a34.4 34.4 0 0 0 5.112-12.77c.369-2.11.557-4.245.562-6.386a36.4 36.4 0 0 0-6.787-21.178z"/><path fill="#fff" d="M55.219 112.662a28.463 34.23 0 0 1-5.954.76a23.64 23.64 0 0 1-19.435-10.187a21.9 21.9 0 0 1-4.08-12.74a15.658 18.83 0 0 1 .333-3.833a15.425 18.55 0 0 1 .72-2.782l.561-1.708l1.52 1.156a38.7 38.7 0 0 0 11.658 5.834l1.104.333l-.104 1.104v.573a6.63 6.63 0 0 0 1.228 3.854a7.1 7.1 0 0 0 2.538 2.288a8.262 9.936 0 0 0 3.312.837a8.251 9.923 0 0 0 1.79-.229a7.272 8.745 0 0 0 1.833-.802l29.76-19.094a6.26 6.26 0 0 0 2.904-5.302a6.62 6.62 0 0 0-1.26-3.844a7.14 7.14 0 0 0-2.553-2.252a8.313 9.997 0 0 0-3.307-.81a8.246 9.917 0 0 0-1.79.23a6.938 8.344 0 0 0-1.822.801l-11.346 7.25a24.376 29.314 0 0 1-6.048 2.656a23.64 23.64 0 0 1-25.39-9.416a21.94 21.94 0 0 1-4.08-12.74c.002-1.285.114-2.567.333-3.833a20.65 20.65 0 0 1 9.286-13.781l29.792-18.99a21.9 21.9 0 0 1 6.048-2.667a24 24 0 0 1 5.954-.75A23.68 23.68 0 0 1 98.22 24.745a21.94 21.94 0 0 1 4.029 12.75a15.748 18.939 0 0 1-.334 3.844a15.407 18.529 0 0 1-.718 2.781l-.562 1.708l-1.52-1.114a38.4 38.4 0 0 0-11.658-5.834l-1.104-.343l.104-1.105v-.572a6.7 6.7 0 0 0-1.228-3.865a7.1 7.1 0 0 0-2.55-2.25a8.309 9.992 0 0 0-3.3-.813a8.221 9.887 0 0 0-1.77.271a6.819 8.2 0 0 0-1.831.802l-29.793 18.99a5.88 7.071 0 0 0-1.836 1.79a4.75 5.713 0 0 0-.963 2.377a5.037 6.057 0 0 0-.136 1.104a6.62 6.62 0 0 0 1.228 3.844a7.1 7.1 0 0 0 2.549 2.25a8.299 9.98 0 0 0 3.301.812a8.247 9.918 0 0 0 1.79-.23a6.943 8.35 0 0 0 1.833-.801l11.367-7.292a24.218 29.125 0 0 1 6.048-2.656a28.526 34.305 0 0 1 5.954-.76A23.66 23.66 0 0 1 96.566 60.61a21.94 21.94 0 0 1 3.737 16.614a20.6 20.6 0 0 1-9.286 13.781l-29.74 18.99a24.308 29.233 0 0 1-6.057 2.667z"/></svg></span>
                <span class="framework-name">Svelte</span>
              </div>
              <div class="framework-option ${frameworkAstroSelected}" onclick="setFramework('astro')" title="Astro">
                <span class="framework-icon"><svg viewBox="0 0 128 128"><defs><linearGradient id="astroGrad1" x1="882.997" x2="638.955" y1="27.113" y2="866.902" gradientTransform="scale(.1)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#000014"/><stop offset="1" stop-color="#150426"/></linearGradient><linearGradient id="astroGrad2" x1="1001.68" x2="790.326" y1="652.45" y2="1094.91" gradientTransform="scale(.1)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#ff1639"/><stop offset="1" stop-color="#ff1639" stop-opacity="0"/></linearGradient></defs><path fill="url(#astroGrad1)" d="M81.504 9.465c.973 1.207 1.469 2.836 2.457 6.09l21.656 71.136a90 90 0 0 0-25.89-8.765L65.629 30.28a1.833 1.833 0 0 0-3.52.004L48.18 77.902a90.1 90.1 0 0 0-26.003 8.778l21.758-71.14c.996-3.25 1.492-4.876 2.464-6.083a8 8 0 0 1 3.243-2.398c1.433-.575 3.136-.575 6.535-.575H71.72c3.402 0 5.105 0 6.543.579a8 8 0 0 1 3.242 2.402Zm0 0"/><path fill="#ff5d01" d="M84.094 90.074c-3.57 3.055-10.696 5.137-18.903 5.137c-10.07 0-18.515-3.137-20.754-7.356c-.8 2.418-.98 5.184-.98 6.954c0 0-.527 8.675 5.508 14.71a5.67 5.67 0 0 1 5.672-5.671c5.37 0 5.367 4.683 5.363 8.488v.336c0 5.773 3.527 10.719 8.543 12.805a11.6 11.6 0 0 1-1.172-5.098c0-5.508 3.23-7.555 6.988-9.938c2.989-1.894 6.309-4 8.594-8.222a15.5 15.5 0 0 0 1.875-7.41a15.6 15.6 0 0 0-.734-4.735m0 0"/><path fill="url(#astroGrad2)" d="M84.094 90.074c-3.57 3.055-10.696 5.137-18.903 5.137c-10.07 0-18.515-3.137-20.754-7.356c-.8 2.418-.98 5.184-.98 6.954c0 0-.527 8.675 5.508 14.71a5.67 5.67 0 0 1 5.672-5.671c5.37 0 5.367 4.683 5.363 8.488v.336c0 5.773 3.527 10.719 8.543 12.805a11.6 11.6 0 0 1-1.172-5.098c0-5.508 3.23-7.555 6.988-9.938c2.989-1.894 6.309-4 8.594-8.222a15.5 15.5 0 0 0 1.875-7.41a15.6 15.6 0 0 0-.734-4.735m0 0"/></svg></span>
                <span class="framework-name">Astro</span>
              </div>
              <div class="framework-option ${frameworkLitSelected}" onclick="setFramework('lit')" title="Lit">
                <span class="framework-icon"><svg viewBox="0 0 128 128"><path fill="#324FFF" d="M32 8l24 16v40L32 80V40L8 56v40l48 32 24-16V72l24 16v-40L56 16 32 32z"/><path fill="#324FFF" opacity=".5" d="M32 40v40l24-16V24z"/><path fill="#00E8FF" d="M56 16l24 16v40L56 56z"/><path fill="#00E8FF" opacity=".7" d="M80 72v40l24-16V56z"/><path fill="#283198" d="M8 56v40l24 16V72z"/><path fill="#324FFF" d="M56 88v40l24-16V72z"/><path fill="#00E8FF" d="M32 80l24 8 24-16-24-8z"/></svg></span>
                <span class="framework-name">Lit</span>
              </div>
            </div>
          </div>

          <div class="help-panel" id="helpPanel">
            <div class="help-content">
              <div class="help-row">
                <span class="help-icon"><svg viewBox="0 0 24 24"><path d="M21 16.5c0 .38-.21.71-.53.88l-7.9 4.44c-.16.12-.36.18-.57.18-.21 0-.41-.06-.57-.18l-7.9-4.44A.991.991 0 0 1 3 16.5v-9c0-.38.21-.71.53-.88l7.9-4.44c.16-.12.36-.18.57-.18.21 0 .41.06.57.18l7.9 4.44c.32.17.53.5.53.88v9zM12 4.15L6.04 7.5 12 10.85l5.96-3.35L12 4.15zM5 15.91l6 3.38v-6.71L5 9.21v6.7zm14 0v-6.7l-6 3.37v6.71l6-3.38z"/></svg></span>
                <div>
                  <strong>${jsModuleTitle}</strong> — ${helpJsModule} <code>&lt;svg-icon name="home"&gt;</code>
                </div>
              </div>
              <div class="help-row">
                <span class="help-icon"><svg viewBox="0 0 24 24"><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg></span>
                <div>
                  <strong>${spriteTitle}</strong> — ${helpSprite}
                </div>
              </div>
              <div class="help-row">
                <span class="help-icon"><svg viewBox="0 0 24 24"><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"/></svg></span>
                <div>
                  <strong>${cssIconsTitle}</strong> — ${helpCssIcons}
                </div>
              </div>
              <div class="help-tip">
                <svg class="svg-icon svg-icon-sm" viewBox="0 0 24 24" style="color: #ffc107;"><path d="M9 21c0 .5.4 1 1 1h4c.6 0 1-.5 1-1v-1H9v1zm3-19C8.1 2 5 5.1 5 9c0 2.4 1.2 4.5 3 5.7V17c0 .5.4 1 1 1h6c.6 0 1-.5 1-1v-2.3c1.8-1.3 3-3.4 3-5.7 0-3.9-3.1-7-7-7z"/></svg>
                <em>${helpTip}</em>
              </div>
            </div>
          </div>

          <!-- Step 4: Web Component Name (only for JS Module) -->
          ${step4Section}

          <!-- Build Options -->
          <div class="build-options">
            <div class="build-options-header">
              <svg viewBox="0 0 24 24"><path d="M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"/></svg>
              <span>${buildOptionsTitle}</span>
            </div>
            <div class="build-options-grid">
              <div class="build-option-item">
                <div class="build-option-icon">
                  <svg viewBox="0 0 24 24"><path d="M4 11h5V5H4v6zm0 7h5v-6H4v6zm6 0h5v-6h-5v6zm6 0h5v-6h-5v6zm-6-7h5V5h-5v6zm6-6v6h5V5h-5z"/></svg>
                </div>
                <div class="build-option-body">
                  <label class="toggle-label">
                    <span>${separateOutputLabel}</span>
                    <input type="checkbox" id="separateOutputStructure" ${separateOutputChecked} onchange="setSeparateOutputStructure(this.checked)">
                    <span class="toggle-switch"></span>
                  </label>
                  <p class="build-option-hint">${separateOutputHint}</p>
                </div>
              </div>
              <div class="build-option-item">
                <div class="build-option-icon">
                  <svg viewBox="0 0 24 24"><path d="M21 3H3c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H3V5h18v14zM5 15h14v3H5z"/></svg>
                </div>
                <div class="build-option-body">
                  <label class="select-label">
                    <span>${previewBackgroundLabel}</span>
                    <select id="previewBackground" onchange="setPreviewBackground(this.value)">
                      <option value="transparent" ${bgTransparent}>Transparent</option>
                      <option value="light" ${bgLight}>Light</option>
                      <option value="dark" ${bgDark}>Dark</option>
                      <option value="checkered" ${bgCheckered}>Checkered</option>
                    </select>
                  </label>
                </div>
              </div>
              <div class="build-option-item">
                <div class="build-option-icon">
                  <svg viewBox="0 0 24 24"><path d="M7 24h2v-2H7v2zm4 0h2v-2h-2v2zm4 0h2v-2h-2v2zM3 0v18h18V0H3zm16 16H5V6h14v10z"/></svg>
                </div>
                <div class="build-option-body">
                  <label class="select-label">
                    <span>${defaultIconSizeLabel}</span>
                    <input type="number" id="defaultIconSize" value="${defaultIconSize}" min="8" max="512" onchange="setDefaultIconSize(this.value)" class="size-input">
                  </label>
                </div>
              </div>
            </div>
          </div>

          </div><!-- /.format-left -->

          <!-- Right: Format Cards -->
          <div class="format-right">
            <div class="format-grid">
              <div class="format-card ${jsModuleSelected}" onclick="setBuildFormat('icons.js')">
                <h3>
                  <svg class="svg-icon" viewBox="0 0 24 24"><path d="M21 16.5c0 .38-.21.71-.53.88l-7.9 4.44c-.16.12-.36.18-.57.18-.21 0-.41-.06-.57-.18l-7.9-4.44A.991.991 0 0 1 3 16.5v-9c0-.38.21-.71.53-.88l7.9-4.44c.16-.12.36-.18.57-.18.21 0 .41.06.57.18l7.9 4.44c.32.17.53.5.53.88v9zM12 4.15L6.04 7.5 12 10.85l5.96-3.35L12 4.15zM5 15.91l6 3.38v-6.71L5 9.21v6.7zm14 0v-6.7l-6 3.37v6.71l6-3.38z"/></svg>
                  ${jsModuleTitle}
                  <span class="badge">${recommended}</span>
                </h3>
                <p>${jsModuleDesc}</p>
                <div class="format-tags">
                  <span class="tag-pro">${jsModulePro1}</span>
                  <span class="tag-pro">${jsModulePro2}</span>
                </div>
              </div>
              <div class="format-card ${spriteSvgSelected}" onclick="setBuildFormat('sprite.svg')">
                <h3>
                  <svg class="svg-icon" viewBox="0 0 24 24"><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg>
                  ${spriteTitle}
                </h3>
                <p>${spriteDesc}</p>
                <div class="format-tags">
                  <span class="tag-neutral">${spritePro1}</span>
                  <span class="tag-neutral">${spritePro2}</span>
                </div>
              </div>
              <div class="format-card ${cssSelected}" onclick="setBuildFormat('css')">
                <h3>
                  <svg class="svg-icon" viewBox="0 0 24 24"><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"/></svg>
                  ${cssIconsTitle}
                </h3>
                <p>${cssIconsDesc}</p>
                <div class="format-tags">
                  <span class="tag-neutral">${cssIconsPro1}</span>
                  <span class="tag-neutral">${cssIconsPro2}</span>
                </div>
              </div>
            </div>
          </div><!-- /.format-right -->

          </div><!-- /.format-layout -->
        </div>
      </div>

      <!-- Steps 2 & 3: Source & Output Directories (same row) -->
      <div class="directories-row">
        <!-- Source Directory -->
        <div class="step ${step1SourceClass}">
          <div class="step-header">
            <div class="step-number ${step1SourceNumberClass}"><span>2</span></div>
            <div class="step-title">${step1SourceTitle}</div>
            ${step1SourceSummary}
          </div>
          <div class="step-content">
            <p class="step-description">${step1SourceDesc}</p>

            <div class="options-grid">
              ${sourceDirectoryOptions}
              <div class="option browse" onclick="chooseSourceFolder()">
                <span class="option-icon"><svg viewBox="0 0 24 24"><path d="M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V8h16v10z"/></svg></span>
                <span class="option-label">${browse}</span>
              </div>
            </div>

            <div class="input-group">
              <input type="text" id="sourceDir" placeholder="${step1SourcePlaceholder}" onkeypress="handleSourcePathKeypress(event)" />
              <button class="btn-secondary" onclick="applyCustomSourcePath()">${step1Apply}</button>
            </div>

            <div class="msignore-option">
              <label class="toggle-label">
                <span>
                  <svg viewBox="0 0 24 24" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 6px; fill: currentColor;"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM4 12c0-4.42 3.58-8 8-8 1.85 0 3.55.63 4.9 1.69L5.69 16.9C4.63 15.55 4 13.85 4 12zm8 8c-1.85 0-3.55-.63-4.9-1.69L18.31 7.1C19.37 8.45 20 10.15 20 12c0 4.42-3.58 8-8 8z"/></svg>
                  ${msignoreLabel}
                </span>
                <input type="checkbox" id="createMsignore" ${msignoreChecked} onchange="setCreateMsignore(this.checked)">
                <span class="toggle-switch"></span>
              </label>
              <p class="msignore-hint">${msignoreHint}</p>
            </div>
          </div>
        </div>

        <!-- Output Directory -->
        <div class="step ${step2Class}">
          <div class="step-header">
            <div class="step-number ${step2NumberClass}"><span>3</span></div>
            <div class="step-title">${step2Title}</div>
            ${step2Summary}
          </div>
          <div class="step-content">
            <p class="step-description">${step2Desc}</p>

            <div class="options-grid">
              ${outputDirectoryOptions}
              <div class="option browse" onclick="chooseFolder()" ${step2Disabled}>
                <span class="option-icon"><svg viewBox="0 0 24 24"><path d="M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V8h16v10z"/></svg></span>
                <span class="option-label">${browse}</span>
              </div>
            </div>

            <div class="input-group">
              <input type="text" id="outputDir" placeholder="${step2Placeholder}" value="${outputDir}" onkeypress="handlePathKeypress(event)" ${step2Disabled} />
              <button class="btn-secondary" onclick="applyCustomPath()" ${step2Disabled}>${step1Apply}</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Preview Section (below configuration) -->
    <div class="preview-section">
      <div class="preview-title">
        <svg class="svg-icon" viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg>
        ${previewTitle}
      </div>

      <div class="preview-layout">
        <!-- Workflow Preview -->
        <div class="workflow-preview">
          <div class="workflow-step">
            <div class="workflow-icon source">
              <svg viewBox="0 0 24 24"><path d="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"/></svg>
            </div>
            <span class="workflow-label">${workflowSource}</span>
            <span class="workflow-path">${sourceDirDisplay}</span>
          </div>
          <div class="workflow-arrow">
            <svg viewBox="0 0 24 24"><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/></svg>
          </div>
          <div class="workflow-step">
            <div class="workflow-icon process">
              <svg viewBox="0 0 24 24"><path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58z"/></svg>
            </div>
            <span class="workflow-label">${workflowBuild}</span>
          </div>
          <div class="workflow-arrow">
            <svg viewBox="0 0 24 24"><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/></svg>
          </div>
          <div class="workflow-step">
            <div class="workflow-icon output">
              <svg viewBox="0 0 24 24"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>
            </div>
            <span class="workflow-label">${workflowOutput}</span>
            <span class="workflow-path">${previewFileName}</span>
          </div>
        </div>

        <!-- Code Preview Window -->
        <div class="preview-window">
          <div class="preview-window-header">
            <div class="preview-dot red"></div>
            <div class="preview-dot yellow"></div>
            <div class="preview-dot green"></div>
            <span class="preview-window-title">${previewWindowTitle}</span>
          </div>
          <div class="preview-code">
            ${previewCode}
          </div>
          <div class="preview-result">
            <div class="preview-result-label">${previewResultLabel}</div>
            ${previewGallery}
          </div>
        </div>
      </div>

      ${previewSummary}

      <!-- Setup Guide -->
      ${setupGuide}

      <!-- Main Action Button -->
      <div class="main-action-container">
        ${finishButton}
      </div>
    </div>
  </div>
</div>
