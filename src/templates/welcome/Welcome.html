<div class="container">
  <!-- Compact Header -->
  <div class="header">
    <div class="header-left">
      <div class="logo-mini">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
        </svg>
      </div>
      <span class="header-title">${appTitle}</span>
    </div>
    <div class="header-features">
      <div class="header-feature"><svg viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg> ${headerIcons}</div>
      <div class="header-feature"><svg viewBox="0 0 24 24"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/></svg> ${headerColors}</div>
      <div class="header-feature"><svg viewBox="0 0 24 24"><path d="M12 2L4.5 20.29l.71.71L12 18l6.79 3 .71-.71L12 2z"/></svg> ${headerAnimations}</div>
      <div class="header-feature"><svg viewBox="0 0 24 24"><path d="M11 21h-1l1-7H7.5c-.58 0-.57-.32-.38-.66.19-.34.05-.08.07-.12C8.48 10.94 10.42 7.54 13 3h1l-1 7h3.5c.49 0 .56.33.47.51l-.07.15C12.96 17.55 11 21 11 21z"/></svg> ${headerSvgo}</div>
      <!-- Language Selector -->
      <div class="header-language">
        <select id="languageSelect" onchange="setLanguage(this.value)" title="${languageLabel}">
          ${languageOptions}
        </select>
      </div>
    </div>
  </div>

  <div class="main-layout">
    <!-- Left Column: Configuration -->
    <div class="config-column">
      <!-- Step 1: Source Directory -->
      <div class="step ${step1SourceClass}">
        <div class="step-header">
          <div class="step-number ${step1SourceNumberClass}"><span>1</span></div>
          <div class="step-title">${step1SourceTitle}</div>
          ${step1SourceSummary}
        </div>
        <div class="step-content">
          <p class="step-description">${step1SourceDesc}</p>
          
          <div class="options-grid">
            <div class="option ${srcAssetsSvgSelected}" onclick="setSourceDirectory('src/assets/svg')">
              <span class="option-icon"><svg viewBox="0 0 24 24"><path d="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"/></svg></span>
              <span class="option-label">src/assets/svg</span>
            </div>
            <div class="option ${srcIconsSvgSelected}" onclick="setSourceDirectory('src/icons')">
              <span class="option-icon"><svg viewBox="0 0 24 24"><path d="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"/></svg></span>
              <span class="option-label">src/icons</span>
            </div>
            <div class="option ${iconsFolderSelected}" onclick="setSourceDirectory('icons')">
              <span class="option-icon"><svg viewBox="0 0 24 24"><path d="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"/></svg></span>
              <span class="option-label">icons</span>
            </div>
            <div class="option browse" onclick="chooseSourceFolder()">
              <span class="option-icon"><svg viewBox="0 0 24 24"><path d="M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V8h16v10z"/></svg></span>
              <span class="option-label">${browse}</span>
            </div>
          </div>
          
          <div class="input-group">
            <input type="text" id="sourceDir" placeholder="${step1SourcePlaceholder}" value="${sourceDir}" onkeypress="handleSourcePathKeypress(event)" />
            <button class="btn-secondary" onclick="applyCustomSourcePath()">${step1Apply}</button>
          </div>
        </div>
      </div>

      <!-- Step 2: Output Directory -->
      <div class="step ${step2Class}">
        <div class="step-header">
          <div class="step-number ${step2NumberClass}"><span>2</span></div>
          <div class="step-title">${step2Title}</div>
          ${step2Summary}
        </div>
        <div class="step-content">
          <p class="step-description">${step2Desc}</p>
          
          <div class="options-grid">
            <div class="option ${srcIconsSelected}" onclick="setDirectory('src/icons')" ${step2Disabled}>
              <span class="option-icon"><svg viewBox="0 0 24 24"><path d="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"/></svg></span>
              <span class="option-label">src/icons</span>
            </div>
            <div class="option ${srcAssetsSelected}" onclick="setDirectory('src/assets/icons')" ${step2Disabled}>
              <span class="option-icon"><svg viewBox="0 0 24 24"><path d="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"/></svg></span>
              <span class="option-label">src/assets/icons</span>
            </div>
            <div class="option ${publicIconsSelected}" onclick="setDirectory('public/icons')" ${step2Disabled}>
              <span class="option-icon"><svg viewBox="0 0 24 24"><path d="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"/></svg></span>
              <span class="option-label">public/icons</span>
            </div>
            <div class="option browse" onclick="chooseFolder()" ${step2Disabled}>
              <span class="option-icon"><svg viewBox="0 0 24 24"><path d="M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V8h16v10z"/></svg></span>
              <span class="option-label">${browse}</span>
            </div>
          </div>
          
          <div class="input-group">
            <input type="text" id="outputDir" placeholder="${step2Placeholder}" value="${outputDir}" onkeypress="handlePathKeypress(event)" ${step2Disabled} />
            <button class="btn-secondary" onclick="applyCustomPath()" ${step2Disabled}>${step1Apply}</button>
          </div>
        </div>
      </div>

      <!-- Step 3: Build Format -->
      <div class="step ${step3Class}">
        <div class="step-header">
          <div class="step-number ${step3NumberClass}"><span>3</span></div>
          <div class="step-title">${step3Title}</div>
          <span class="step-summary" style="color: var(--vscode-descriptionForeground);">${formatSummary}</span>
        </div>
        <div class="step-content">
          <p class="step-description">
            ${step3Desc} 
            <span class="help-link" onclick="toggleHelp()">${step3Help} ▾</span>
          </p>
          
          <div class="help-panel" id="helpPanel">
            <div class="help-content">
              <div class="help-row">
                <span class="help-icon"><svg viewBox="0 0 24 24"><path d="M21 16.5c0 .38-.21.71-.53.88l-7.9 4.44c-.16.12-.36.18-.57.18-.21 0-.41-.06-.57-.18l-7.9-4.44A.991.991 0 0 1 3 16.5v-9c0-.38.21-.71.53-.88l7.9-4.44c.16-.12.36-.18.57-.18.21 0 .41.06.57.18l7.9 4.44c.32.17.53.5.53.88v9zM12 4.15L6.04 7.5 12 10.85l5.96-3.35L12 4.15zM5 15.91l6 3.38v-6.71L5 9.21v6.7zm14 0v-6.7l-6 3.37v6.71l6-3.38z"/></svg></span>
                <div>
                  <strong>${jsModuleTitle}</strong> — ${helpJsModule} <code>&lt;sg-icon name="home"&gt;</code>
                </div>
              </div>
              <div class="help-row">
                <span class="help-icon"><svg viewBox="0 0 24 24"><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg></span>
                <div>
                  <strong>${spriteTitle}</strong> — ${helpSprite}
                </div>
              </div>
              <div class="help-tip">
                <svg class="svg-icon svg-icon-sm" viewBox="0 0 24 24" style="color: #ffc107;"><path d="M9 21c0 .5.4 1 1 1h4c.6 0 1-.5 1-1v-1H9v1zm3-19C8.1 2 5 5.1 5 9c0 2.4 1.2 4.5 3 5.7V17c0 .5.4 1 1 1h6c.6 0 1-.5 1-1v-2.3c1.8-1.3 3-3.4 3-5.7 0-3.9-3.1-7-7-7z"/></svg>
                <em>${helpTip}</em>
              </div>
            </div>
          </div>
          
          <div class="format-grid">
            <div class="format-card ${jsModuleSelected}" onclick="setBuildFormat('icons.ts')">
              <h3>
                <svg class="svg-icon" viewBox="0 0 24 24"><path d="M21 16.5c0 .38-.21.71-.53.88l-7.9 4.44c-.16.12-.36.18-.57.18-.21 0-.41-.06-.57-.18l-7.9-4.44A.991.991 0 0 1 3 16.5v-9c0-.38.21-.71.53-.88l7.9-4.44c.16-.12.36-.18.57-.18.21 0 .41.06.57.18l7.9 4.44c.32.17.53.5.53.88v9zM12 4.15L6.04 7.5 12 10.85l5.96-3.35L12 4.15zM5 15.91l6 3.38v-6.71L5 9.21v6.7zm14 0v-6.7l-6 3.37v6.71l6-3.38z"/></svg>
                ${jsModuleTitle}
                <span class="badge">${recommended}</span>
              </h3>
              <p>${jsModuleDesc}</p>
              <div class="format-tags">
                <span class="tag-pro">${jsModulePro1}</span>
                <span class="tag-pro">${jsModulePro2}</span>
              </div>
            </div>
            <div class="format-card disabled">
              <h3>
                <svg class="svg-icon" viewBox="0 0 24 24"><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg>
                ${spriteTitle}
                <span class="badge-soon">${comingSoon}</span>
              </h3>
              <p>${spriteDesc}</p>
              <div class="format-tags">
                <span class="tag-neutral">${spritePro1}</span>
                <span class="tag-neutral">${spritePro2}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Step 4: Web Component Name (only for JS Module) -->
      ${step4Section}

      <!-- Step 5: License Consent for Iconify -->
      ${step5Section}
    </div>

    <!-- Right Column: Live Preview -->
    <div class="preview-column">
      <div class="preview-title">
        <svg class="svg-icon" viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg>
        ${previewTitle}
      </div>

      <!-- Workflow Preview -->
      <div class="workflow-preview">
        <div class="workflow-step">
          <div class="workflow-icon source">
            <svg viewBox="0 0 24 24"><path d="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"/></svg>
          </div>
          <span class="workflow-label">${workflowSource}</span>
          <span class="workflow-path">${sourceDirDisplay}</span>
        </div>
        <div class="workflow-arrow">
          <svg viewBox="0 0 24 24"><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/></svg>
        </div>
        <div class="workflow-step">
          <div class="workflow-icon process">
            <svg viewBox="0 0 24 24"><path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58z"/></svg>
          </div>
          <span class="workflow-label">${workflowBuild}</span>
        </div>
        <div class="workflow-arrow">
          <svg viewBox="0 0 24 24"><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/></svg>
        </div>
        <div class="workflow-step">
          <div class="workflow-icon output">
            <svg viewBox="0 0 24 24"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>
          </div>
          <span class="workflow-label">${workflowOutput}</span>
          <span class="workflow-path">${previewFileName}</span>
        </div>
      </div>
      
      <div class="preview-window">
        <div class="preview-window-header">
          <div class="preview-dot red"></div>
          <div class="preview-dot yellow"></div>
          <div class="preview-dot green"></div>
          <span class="preview-window-title">example.js</span>
        </div>
        <div class="preview-code">
          ${previewCode}
        </div>
        <div class="preview-result">
          <div class="preview-result-label">${previewResultLabel}</div>
          ${previewGallery}
        </div>
      </div>
      
      ${previewSummary}

      <!-- Main Action Button - Always Visible -->
      <div class="main-action-container">
        ${finishButton}
      </div>

      <!-- Advanced Options (collapsible) -->
      <div class="advanced-options-panel">
        <div class="advanced-header" onclick="toggleAdvanced()">
          <div class="advanced-title">
            <svg viewBox="0 0 24 24"><path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
            <span>${advancedTitle}</span>
          </div>
          <svg class="toggle-chevron" id="advancedArrow" viewBox="0 0 24 24"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
        </div>
        <div class="advanced-content" id="advancedContent">
          <div class="advanced-grid">
            <div class="advanced-item">
              <label class="toggle-label">
                <span>${svgoOptimizeLabel}</span>
                <input type="checkbox" id="svgoOptimize" ${svgoOptimizeChecked} onchange="setSvgoOptimize(this.checked)">
                <span class="toggle-switch"></span>
              </label>
            </div>
            <div class="advanced-item">
              <label class="toggle-label">
                <span>${scanOnStartupLabel}</span>
                <input type="checkbox" id="scanOnStartup" ${scanOnStartupChecked} onchange="setScanOnStartup(this.checked)">
                <span class="toggle-switch"></span>
              </label>
            </div>
            <div class="advanced-item">
              <label class="select-label">
                <span>${defaultIconSizeLabel}</span>
                <input type="number" id="defaultIconSize" value="${defaultIconSize}" min="8" max="512" onchange="setDefaultIconSize(this.value)" class="size-input">
              </label>
            </div>
            <div class="advanced-item">
              <label class="select-label">
                <span>${previewBackgroundLabel}</span>
                <select id="previewBackground" onchange="setPreviewBackground(this.value)">
                  <option value="transparent" ${bgTransparent}>Transparent</option>
                  <option value="light" ${bgLight}>Light</option>
                  <option value="dark" ${bgDark}>Dark</option>
                  <option value="checkered" ${bgCheckered}>Checkered</option>
                </select>
              </label>
            </div>
          </div>
          <div class="advanced-actions">
            <button class="btn-secondary-outline" onclick="openSettings()">
              <svg viewBox="0 0 24 24"><path d="M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"/></svg>
              ${allSettings}
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
